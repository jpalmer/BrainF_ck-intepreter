;The aim of this is to create a brainfuck intepreter
;status - trying for speed increases 
extern malloc
extern putchar
;due to different calling convention, the registers that we use depend on the OS
%ifdef WIN64
	%define vd rcx
    %define main WinMain ;on windows main is not called main
%endif
%ifdef LIN64
    %define vd rdi
%endif
global main

segment .text
main:
	push   rbp
   	mov    rbp,rsp
%ifdef WIN64 ;not sure precisely what this does, got it by doing an objdump of a c exe - consider it magic
   	sub    rsp,0x20
%elifdef LIN64
    sub rsp,0x10
%endif
    ;allocate memory for memory
	mov vd,  0x5000000
	call malloc	
    mov rbx, rax
	mov vd, [rbx]
